---
title: "The `sprtt` package"
output:
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 3
description: >
  This vignette describes the sequential t-test and the usage of the
  `sprtt` package.
vignette: >
  %\VignetteIndexEntry{The `sprtt` package}
  %\VignetteEncoding{UTF-8}{inputenc}
  %\VignetteEngine{knitr::rmarkdown}
bibliography: references.bib
csl: "apa.csl"
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Overview

The `sprtt` package is the implementation of **s**equential **p**robability **r**atio **t**ests using the associated **t**-statistic (**sprtt**). This vignette describes the background of the tests and demonstrates the usage of the package including the `seq_ttest()` function.

## Sequential t-Test

### What is a sequential test procedure?

Sequential tests are designed to be applied repeatedly during the sampling process and terminate as soon as there is sufficient evidence for the null or alternative hypothesis. Therefore the sequential procedure has the advantage to substantially reduce the required sample size without compromising predefined error probabilities [@schnuerch2020a].

### What is the sequential t-test?

The sequential t-test is based on the Sequential Probability Ratio Test (SPRT) by Abraham @wald1947, which is a highly efficient sequential hypothesis test. However, the usage of WaldÂ´s SPRT is limited for normally distributed data, because the variance has to be known or specified in the hypothesis. Rushton [-@rushton1950a; -@rushton1952] and @hajnal1961 developed the SPRT further using the t-statistic. The basic idea is to transform the sequence of observations (which is dependent of the variance) into a sequence of the associated t-statistic (which is *in*dependent of the variance).

The test statistic is a likelihood ratio with the model parameter ğœƒ.

$$
LR_{10} 
= \frac {f(data_m | model_1)} {f(data_m | model_0)}
= \frac {ğ‘“(D_m | ğœƒ_1)} {ğ‘“(D_m | ğœƒ_1)} 
$$

More specific, the ratio of the likelihood of the alternative hypothesis to the likelihood of the null hypothesis at the *m*-th step of the of the sampling process (LR~m~).

$$
LR_{m,\ one-sided\ sequential\ t-test} 
= \frac {ğ‘“(t_m | ğœƒ_1)} {ğ‘“(t_m | ğœƒ_1)}
\\ 
LR_{m,\ two-sided\ sequential\ t-test} 
= \frac {ğ‘“(t_m^2 | ğœƒ_1)} {ğ‘“(t_m^2 | ğœƒ_1)}
$$

Depending on the predefined A and B boundaries the decision will be either to continue sampling or to terminate and accept one of the hypotheses [@schnuerch2020a].

|    Condition    |                    Decision |
|:---------------:|----------------------------:|
|    LR~m~ â‰¤ B    | accept H~0~ and reject H~1~ |
| B \< LR~m~ \< A |           continue sampling |
|    LR~m~ â‰¤ A    | accept H~1~ and reject H~0~ |

The A and B boundaries are calculated with the previous defined error rates ğ›¼ (Type I error) and ğ›½ (Type II error) as follows:

$$
A = \left( \frac{1 - ğ›½}{ğ›¼} \right) \\
B = \left( \frac{ğ›½}{1 - ğ›¼} \right).
$$

The test is to be applied to the data during the sampling process, ideally after each observation, otherwise it will have an impact on the efficiency of the test.

## Usage of the `sprtt` package

### How do I use the `seq_ttest()` function?

### Examples

```{r}
library(sprtt)
# data set
head(df_income)
```

```{r}
# data set
# df_income
```

## References
